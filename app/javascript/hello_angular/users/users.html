<div class="row set-margin">
  <div class="col-lg-12">
    <h3 class="text-left">User</h3>
  </div>
  <div class="col-lg-12">
    <div class="row">
      <div class="col-lg-8"></div>
      <div class="col-lg-4 pull-right">
        <input type="text" placeholder="Type to filter the name column..." (keyup)="search($event)">
      </div>
    </div>
    <div>
      <ngx-datatable #usersTable class="material expandable" [loadingIndicator]="loading" [externalSorting]="true"
        [rows]="rows" [columnMode]="'force'" [headerHeight]="50" [footerHeight]="50" [rowHeight]="'auto'"
        [externalPaging]="true" [count]="page.total" [offset]="page.page_now" [limit]="page.limit"
        (page)="pageChanged($event)" (sort)="sort($event)">

        <ngx-datatable-row-detail [rowHeight]="100" #usersDetailRow>
          <ng-template let-row="row" let-expanded="expanded" ngx-datatable-row-detail-template>
            <div class="padding-left-35">
              <div><strong>Details</strong></div>
              <div><img [src]="row.photo_url" class="img-lg"> Full Name: {{ row.full_name }}</div>
            </div>
          </ng-template>
        </ngx-datatable-row-detail>

        <ngx-datatable-column [width]="50" [resizeable]="false" [sortable]="false" [draggable]="false"
          [canAutoResize]="false">
          <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template>
            <a href="javascript:void(0)" [class.datatable-icon-right]="!expanded" [class.datatable-icon-down]="expanded"
              title="Expand/Collapse Row" (click)="toggleExpandRow(row)">
            </a>
          </ng-template>
        </ngx-datatable-column>

        <ngx-datatable-column prop="id" name="ID">
          <ng-template let-row="row" let-value="value" ngx-datatable-cell-template>
            {{ row.id }}
          </ng-template>
        </ngx-datatable-column>

        <ngx-datatable-column prop="email" name="Email">
          <ng-template let-row="row" let-value="value" ngx-datatable-cell-template>
            <a class="nav-link" routerLink="/users/{{ row.id }}" routerLinkActive="active">{{ row.email }}</a>
          </ng-template>
        </ngx-datatable-column>

        <ngx-datatable-column prop="first_name" name="Full Name">
          <ng-template let-row="row" let-value="value" ngx-datatable-cell-template>
            <a class="nav-link" routerLink="/users/{{ row.id }}" routerLinkActive="active">{{ row.full_name }}</a>
          </ng-template>
        </ngx-datatable-column>

        <ngx-datatable-column prop="phone_number" name="Phone Number">
          <ng-template let-row="row" let-value="value" ngx-datatable-cell-template>
            {{ row.phone_number }}
          </ng-template>
        </ngx-datatable-column>

        <ngx-datatable-column prop="created_at" name="Created At">
          <ng-template let-row="row" let-value="value" ngx-datatable-cell-template>
            {{ row.created_at_formatted }}
          </ng-template>
        </ngx-datatable-column>

        <ngx-datatable-column prop="updated_at" name="Updated At">
          <ng-template let-row="row" let-value="value" ngx-datatable-cell-template>
            {{ row.updated_at_formatted }}
          </ng-template>
        </ngx-datatable-column>

        <ngx-datatable-column>
          <ng-template let-row="row" let-value="value" ngx-datatable-cell-template>
            <button [disabled]="!sessions.current_user.admin" class="btn btn-danger"
              (click)="removeUser(row.id)">Delete</button>
          </ng-template>
        </ngx-datatable-column>
      </ngx-datatable>
    </div>
    <!-- <table class=" table" *ngIf="datas.users">
        <thead>
          <tr>
            <th>ID</th>
            <th>Email</th>
            <th>Full Name</th>
            <th>Phone Number</th>
            <th>Create At</th>
            <th>Update At</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let user of datas.users | paginate: config ">
            <td>{{ user.id }}</td>
            <td><a routerLink="/users/{{ user.id }}">{{ user.email }}</a></td>
            <td><a routerLink="/users/{{ user.id }}">{{ user.first_name }} {{ user.last_name }}</a></td>
            <td><a routerLink="/users/{{ user.id }}">{{ user.last_name }}</a></td>
            <td>{{ user.phone_number }}</td>
            <td>{{ user.created_at | date:'dd/MM/yyyy เวลา HH:mm' }}</td>
            <td>{{ user.updated_at | date:'dd/MM/yyyy เวลา HH:mm' }}</td>
            <td><button [disabled]="!sessions.signed_in" class="btn btn-danger"
                (click)="removeUser(user.id)">Delete</button></td>
          </tr>
        </tbody>
        </table>

        <div class="row">
          <pagination-controls (pageChange)="pageChanged($event)"></pagination-controls>
          <div class="col-lg-1 pull-right">
            <select [(ngModel)]="limit" class="form-control" (change)="loadTable()">
              <option *ngFor="let limit of limited" [value]="limit">{{ limit }}</option>
            </select>
          </div>
        </div> -->
  </div>
</div>